{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://example.com/schemas/04-application-layer.schema.json",
  "title": "Application Layer Schema",
  "description": "Describes application services, components, and interfaces that support business processes and bridge requirements with technical implementation.",
  "type": "object",
  "properties": {
    "application-components": {
      "type": "array",
      "description": "Collection of ApplicationComponent entities",
      "items": {
        "$ref": "#/definitions/ApplicationComponent"
      }
    },
    "application-collaborations": {
      "type": "array",
      "description": "Collection of ApplicationCollaboration entities",
      "items": {
        "$ref": "#/definitions/ApplicationCollaboration"
      }
    },
    "application-interfaces": {
      "type": "array",
      "description": "Collection of ApplicationInterface entities",
      "items": {
        "$ref": "#/definitions/ApplicationInterface"
      }
    },
    "application-functions": {
      "type": "array",
      "description": "Collection of ApplicationFunction entities",
      "items": {
        "$ref": "#/definitions/ApplicationFunction"
      }
    },
    "application-interactions": {
      "type": "array",
      "description": "Collection of ApplicationInteraction entities",
      "items": {
        "$ref": "#/definitions/ApplicationInteraction"
      }
    },
    "application-processes": {
      "type": "array",
      "description": "Collection of ApplicationProcess entities",
      "items": {
        "$ref": "#/definitions/ApplicationProcess"
      }
    },
    "application-events": {
      "type": "array",
      "description": "Collection of ApplicationEvent entities",
      "items": {
        "$ref": "#/definitions/ApplicationEvent"
      }
    },
    "application-services": {
      "type": "array",
      "description": "Collection of ApplicationService entities",
      "items": {
        "$ref": "#/definitions/ApplicationService"
      }
    },
    "data-objects": {
      "type": "array",
      "description": "Collection of DataObject entities",
      "items": {
        "$ref": "#/definitions/DataObject"
      }
    }
  },
  "definitions": {
    "ApplicationComponent": {
      "type": "object",
      "description": "Modular, deployable, and replaceable part of a system",
      "required": [
        "id",
        "name",
        "type"
      ],
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid",
          "minLength": 1
        },
        "name": {
          "type": "string",
          "minLength": 1
        },
        "documentation": {
          "type": "string",
          "minLength": 1
        },
        "type": {
          "$ref": "#/definitions/enum"
        },
        "properties": {
          "type": "object",
          "description": "Cross-layer properties",
          "properties": {
            "implementation": {
              "type": "object",
              "properties": {
                "framework": {
                  "type": "string",
                  "description": "optional"
                }
              }
            },
            "spec": {
              "type": "object",
              "properties": {
                "ux": {
                  "type": "string",
                  "description": "optional"
                },
                "openapi": {
                  "type": "string",
                  "description": "optional"
                }
              }
            }
          }
        }
      },
      "definitions": {
        "ComponentType": {
          "type": "string",
          "enum": [
            "frontend",
            "backend",
            "mobile",
            "desktop",
            "service"
          ]
        }
      },
      "allOf": [
        {
          "$ref": "common/relationships.schema.json#/definitions/ConditionalCriticalityRequirements"
        }
      ]
    },
    "ApplicationCollaboration": {
      "type": "object",
      "description": "Aggregate of application components working together",
      "required": [
        "id",
        "name"
      ],
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid",
          "minLength": 1
        },
        "name": {
          "type": "string",
          "minLength": 1
        },
        "documentation": {
          "type": "string",
          "minLength": 1
        },
        "components": {
          "type": "array",
          "description": "Contains relationship",
          "items": {
            "type": "string"
          }
        }
      }
    },
    "ApplicationInterface": {
      "type": "object",
      "description": "Point of access where application service is available",
      "required": [
        "id",
        "name",
        "protocol"
      ],
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid",
          "minLength": 1
        },
        "name": {
          "type": "string",
          "minLength": 1
        },
        "documentation": {
          "type": "string",
          "minLength": 1
        },
        "protocol": {
          "$ref": "#/definitions/enum"
        },
        "properties": {
          "type": "object",
          "description": "Cross-layer properties",
          "properties": {
            "spec": {
              "type": "object",
              "properties": {
                "openapi": {
                  "type": "string",
                  "description": "optional"
                }
              }
            },
            "interface": {
              "type": "object",
              "properties": {
                "endpoint": {
                  "type": "string",
                  "description": "optional"
                }
              }
            }
          }
        }
      },
      "definitions": {
        "InterfaceProtocol": {
          "type": "string",
          "enum": [
            "REST",
            "GraphQL",
            "SOAP",
            "gRPC",
            "WebSocket",
            "Message Queue"
          ]
        }
      }
    },
    "ApplicationFunction": {
      "type": "object",
      "description": "Automated behavior performed by application component",
      "required": [
        "id",
        "name"
      ],
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid",
          "minLength": 1
        },
        "name": {
          "type": "string",
          "minLength": 1
        },
        "documentation": {
          "type": "string",
          "minLength": 1
        },
        "properties": {
          "type": "object",
          "description": "Cross-layer properties",
          "properties": {
            "function": {
              "type": "object",
              "properties": {
                "async": {
                  "type": "string",
                  "description": "optional"
                },
                "idempotent": {
                  "type": "string",
                  "description": "optional"
                }
              }
            },
            "motivation": {
              "type": "object",
              "properties": {
                "fulfills-requirements": {
                  "allOf": [
                    {
                      "$ref": "common/relationships.schema.json#/definitions/MotivationProperties/properties/fulfills-requirements"
                    }
                  ]
                },
                "governed-by-principles": {
                  "allOf": [
                    {
                      "$ref": "common/relationships.schema.json#/definitions/MotivationProperties/properties/governed-by"
                    }
                  ]
                }
              }
            }
          }
        }
      }
    },
    "ApplicationInteraction": {
      "type": "object",
      "description": "Unit of collective application behavior",
      "required": [
        "id",
        "name",
        "pattern"
      ],
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid",
          "minLength": 1
        },
        "name": {
          "type": "string",
          "minLength": 1
        },
        "documentation": {
          "type": "string",
          "minLength": 1
        },
        "pattern": {
          "$ref": "#/definitions/enum"
        }
      },
      "definitions": {
        "InteractionPattern": {
          "type": "string",
          "enum": [
            "request-response",
            "publish-subscribe",
            "async-messaging",
            "streaming"
          ]
        }
      }
    },
    "ApplicationProcess": {
      "type": "object",
      "description": "Sequence of application behaviors",
      "required": [
        "id",
        "name"
      ],
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid",
          "minLength": 1
        },
        "name": {
          "type": "string",
          "minLength": 1
        },
        "documentation": {
          "type": "string",
          "minLength": 1
        },
        "properties": {
          "type": "object",
          "description": "Cross-layer properties",
          "properties": {
            "process": {
              "type": "object",
              "properties": {
                "orchestration": {
                  "type": "string",
                  "description": "optional"
                },
                "saga": {
                  "type": "string",
                  "description": "optional"
                }
              }
            }
          }
        }
      }
    },
    "ApplicationEvent": {
      "type": "object",
      "description": "Application state change notification",
      "required": [
        "id",
        "name",
        "eventType"
      ],
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid",
          "minLength": 1
        },
        "name": {
          "type": "string",
          "minLength": 1
        },
        "documentation": {
          "type": "string",
          "minLength": 1
        },
        "eventType": {
          "$ref": "#/definitions/enum"
        },
        "properties": {
          "type": "object",
          "description": "Cross-layer properties",
          "properties": {
            "event": {
              "type": "object",
              "properties": {
                "schema": {
                  "type": "string",
                  "description": "optional"
                },
                "topic": {
                  "type": "string",
                  "description": "optional"
                }
              }
            }
          }
        }
      },
      "definitions": {
        "ApplicationEventType": {
          "type": "string",
          "enum": [
            "domain-event",
            "integration-event",
            "system-event",
            "audit-event"
          ]
        }
      }
    },
    "ApplicationService": {
      "type": "object",
      "description": "Service that exposes application functionality",
      "required": [
        "id",
        "name",
        "serviceType"
      ],
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid",
          "minLength": 1
        },
        "name": {
          "type": "string",
          "minLength": 1
        },
        "documentation": {
          "type": "string",
          "minLength": 1
        },
        "serviceType": {
          "$ref": "#/definitions/enum"
        },
        "properties": {
          "type": "object",
          "description": "Cross-layer properties",
          "properties": {
            "spec": {
              "type": "object",
              "properties": {
                "openapi": {
                  "type": "string",
                  "description": "optional"
                }
              }
            },
            "service": {
              "type": "object",
              "properties": {
                "version": {
                  "type": "string",
                  "description": "optional"
                },
                "deprecated": {
                  "type": "string",
                  "description": "optional"
                }
              }
            },
            "apm": {
              "type": "object",
              "properties": {
                "traced": {
                  "type": "string",
                  "description": "optional"
                },
                "business-metrics": {
                  "type": "string",
                  "description": "optional, comma-separated business metric IDs this service tracks"
                },
                "sla-target-latency": {
                  "type": "string",
                  "description": "optional, target response time"
                },
                "sla-target-availability": {
                  "type": "string",
                  "description": "optional, target uptime percentage"
                }
              }
            },
            "motivation": {
              "type": "object",
              "properties": {
                "supports-goals": {
                  "allOf": [
                    {
                      "$ref": "common/relationships.schema.json#/definitions/MotivationProperties/properties/supports-goals"
                    }
                  ]
                },
                "delivers-value": {
                  "allOf": [
                    {
                      "$ref": "common/relationships.schema.json#/definitions/MotivationProperties/properties/delivers-value"
                    }
                  ]
                },
                "governed-by-principles": {
                  "allOf": [
                    {
                      "$ref": "common/relationships.schema.json#/definitions/MotivationProperties/properties/governed-by"
                    }
                  ]
                }
              }
            }
          }
        }
      },
      "definitions": {
        "ServiceType": {
          "type": "string",
          "enum": [
            "synchronous",
            "asynchronous",
            "batch",
            "streaming"
          ]
        }
      },
      "allOf": [
        {
          "$ref": "common/relationships.schema.json#/definitions/ConditionalCriticalityRequirements"
        }
      ]
    },
    "DataObject": {
      "type": "object",
      "description": "Data structured for automated processing",
      "required": [
        "id",
        "name"
      ],
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid",
          "minLength": 1
        },
        "name": {
          "type": "string",
          "minLength": 1
        },
        "documentation": {
          "type": "string",
          "minLength": 1
        },
        "properties": {
          "type": "object",
          "description": "Cross-layer properties",
          "properties": {
            "spec": {
              "type": "object",
              "properties": {
                "schema": {
                  "type": "string",
                  "description": "optional"
                },
                "database": {
                  "type": "string",
                  "description": "optional"
                }
              }
            },
            "data": {
              "type": "object",
              "properties": {
                "pii": {
                  "type": "string",
                  "description": "optional"
                },
                "retention": {
                  "type": "string",
                  "description": "optional"
                }
              }
            }
          }
        }
      }
    }
  },
  "$defs": {
    "relationships": {
      "$ref": "common/relationships.schema.json#/definitions"
    },
    "predicates": {
      "$ref": "common/predicates.schema.json#/definitions"
    }
  }
}
