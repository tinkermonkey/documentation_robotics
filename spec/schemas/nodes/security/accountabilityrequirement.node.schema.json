{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "AccountabilityRequirement",
  "description": "Expresses who is obligated to provide evidence that a specific action occurred and under what conditions that evidence can be challenged. Distinct from AuditConfig, which defines what events are captured \u2014 this node defines the obligation to prove an action took place. Implements NIST SP 800-53 AU-10 non-repudiation.",
  "allOf": [
    {
      "$ref": "../../base/spec-node.schema.json"
    }
  ],
  "properties": {
    "spec_node_id": {
      "const": "security.accountabilityrequirement"
    },
    "layer_id": {
      "const": "security"
    },
    "type": {
      "const": "accountabilityrequirement"
    },
    "attributes": {
      "type": "object",
      "properties": {
        "action": {
          "type": "string"
        },
        "resource": {
          "type": "string"
        },
        "nonRepudiation": {
          "type": "boolean"
        },
        "purposeDeclaration": {
          "type": "string"
        },
        "challengeable": {
          "type": "boolean"
        }
      },
      "required": ["action", "resource", "nonRepudiation", "purposeDeclaration", "challengeable"],
      "additionalProperties": false
    }
  }
}
