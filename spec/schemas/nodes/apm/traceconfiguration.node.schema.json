{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "TraceConfiguration",
  "description": "OTel TracerProvider configuration covering sampler selection, context propagation formats, and span processor pipeline. Service identity attributes (serviceName, serviceVersion, deploymentEnvironment) are OTel Resource semantic conventions and belong on the Resource node.",
  "allOf": [
    {
      "$ref": "../../base/spec-node.schema.json"
    }
  ],
  "properties": {
    "spec_node_id": {
      "const": "apm.traceconfiguration"
    },
    "layer_id": {
      "const": "apm"
    },
    "type": {
      "const": "traceconfiguration"
    },
    "attributes": {
      "type": "object",
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid"
        },
        "name": {
          "type": "string"
        },
        "source": {
          "type": "object",
          "description": "Source code reference for trace configuration"
        },
        "samplerType": {
          "type": "string",
          "enum": [
            "always_on",
            "always_off",
            "trace_id_ratio",
            "parent_based_always_on",
            "parent_based_always_off",
            "parent_based_trace_id_ratio"
          ],
          "description": "OTel SDK sampler type controlling which traces are recorded"
        },
        "propagators": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": ["tracecontext", "baggage", "b3", "b3multi", "xray", "jaeger"]
          },
          "description": "OTel context propagation formats enabled for this trace configuration"
        },
        "samplerParam": {
          "type": "number",
          "minimum": 0.0,
          "maximum": 1.0,
          "description": "Sampling rate for ratio-based samplers (trace_id_ratio, parent_based_trace_id_ratio). Value between 0.0 (sample none) and 1.0 (sample all). Ignored for non-ratio sampler types."
        }
      },
      "required": [],
      "additionalProperties": false
    }
  }
}
