{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "AccessPattern",
  "description": "A documented data access pattern that describes how applications read or write data. Critical for NoSQL data modeling where schema design is driven by access patterns rather than normalization.",
  "allOf": [
    {
      "$ref": "../../base/spec-node.schema.json"
    }
  ],
  "properties": {
    "spec_node_id": {
      "const": "data-store.accesspattern"
    },
    "layer_id": {
      "const": "data-store"
    },
    "type": {
      "const": "accesspattern"
    },
    "attributes": {
      "type": "object",
      "properties": {
        "patternType": {
          "type": "string",
          "enum": [
            "POINT_READ",
            "RANGE_SCAN",
            "FULL_SCAN",
            "WRITE",
            "UPSERT",
            "BATCH_WRITE",
            "AGGREGATION",
            "SEARCH",
            "VECTOR_SIMILARITY",
            "GRAPH_TRAVERSAL",
            "TIME_RANGE",
            "LATEST_VALUE",
            "CUSTOM"
          ],
          "description": "Category of access pattern. POINT_READ: single-record lookup by key. RANGE_SCAN: ordered range of records. FULL_SCAN: all records. WRITE/UPSERT/BATCH_WRITE: mutation patterns. AGGREGATION: computed result over records. SEARCH: full-text or filtered search. VECTOR_SIMILARITY: approximate nearest neighbor. GRAPH_TRAVERSAL: multi-hop graph walk. TIME_RANGE/LATEST_VALUE: time-series queries."
        },
        "targetCollection": {
          "type": "string",
          "description": "The collection this access pattern operates on."
        },
        "keyCondition": {
          "type": "string",
          "description": "Key or partition condition for this access (e.g., 'customer_id = :id', 'PK = USER#:userId AND SK BEGINS_WITH ORDER#')."
        },
        "sortKey": {
          "type": "string",
          "description": "Sort key expression for composite key patterns (e.g., 'SK BEGINS_WITH ORDER#', 'timestamp BETWEEN :start AND :end'). Used in DynamoDB/Cassandra to define the clustering dimension of the access pattern."
        },
        "filterCondition": {
          "type": "string",
          "description": "Additional filter condition applied after key lookup."
        },
        "expectedFrequency": {
          "type": "string",
          "enum": ["RARE", "OCCASIONAL", "FREQUENT", "HIGH_THROUGHPUT", "REAL_TIME"],
          "description": "Expected frequency of this access pattern. Informs capacity planning and index decisions."
        },
        "consistencyRequirement": {
          "type": "string",
          "enum": ["STRONG", "EVENTUAL", "SESSION", "CAUSAL", "LINEARIZABLE"],
          "description": "Required consistency level for this access pattern."
        },
        "x-source-reference": {
          "type": "string",
          "description": "Source code reference using OpenAPI x- extension pattern."
        }
      },
      "required": ["patternType", "targetCollection"],
      "additionalProperties": false
    }
  }
}
