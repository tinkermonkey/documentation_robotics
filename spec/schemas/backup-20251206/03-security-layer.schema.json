{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://example.com/schemas/03-security-layer.json",
  "title": "Security Layer Schema",
  "type": "object",
  "description": "ArchiMate Security Layer elements for business services, processes, actors, and objects",
  "properties": {
    "securityModels": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/SecurityModel"
      }
    },
    "authenticationConfigs": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/AuthenticationConfig"
      }
    },
    "passwordPolicies": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/PasswordPolicy"
      }
    },
    "roles": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/Role"
      }
    },
    "permissions": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/Permission"
      }
    },
    "secureResources": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/SecureResource"
      }
    },
    "resourceOperations": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/ResourceOperation"
      }
    },
    "accessConditions": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/AccessCondition"
      }
    },
    "fieldAccessControls": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/FieldAccessControl"
      }
    },
    "securityPolicies": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/SecurityPolicy"
      }
    },
    "policyRules": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/PolicyRule"
      }
    },
    "policyActions": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/PolicyAction"
      }
    },
    "actors": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/Actor"
      }
    },
    "actorObjectives": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/ActorObjective"
      }
    },
    "actorDependencies": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/ActorDependency"
      }
    },
    "informationEntities": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/InformationEntity"
      }
    },
    "informationRights": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/InformationRight"
      }
    },
    "delegations": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/Delegation"
      }
    },
    "socialDependencies": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/SocialDependency"
      }
    },
    "accountabilityRequirements": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/AccountabilityRequirement"
      }
    },
    "evidences": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/Evidence"
      }
    },
    "threats": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/Threat"
      }
    },
    "countermeasures": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/Countermeasure"
      }
    },
    "relationships": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/Relationship"
      }
    }
  },
  "definitions": {
    "SecurityModel": {
      "type": "object",
      "description": "Complete security model for application",
      "required": [
        "id",
        "name",
        "version",
        "application"
      ],
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid"
        },
        "name": {
          "type": "string",
          "minLength": 1
        },
        "version": {
          "type": "string"
        },
        "application": {
          "type": "string"
        },
        "authentication": {
          "type": "array",
          "items": {
            "type": "string",
            "format": "uuid"
          },
          "minItems": 1,
          "maxItems": 1,
          "description": "References to AuthenticationConfig IDs"
        },
        "actors": {
          "type": "array",
          "items": {
            "type": "string",
            "format": "uuid"
          },
          "minItems": 0,
          "description": "References to Actor IDs"
        },
        "roles": {
          "type": "array",
          "items": {
            "type": "string",
            "format": "uuid"
          },
          "minItems": 1,
          "description": "References to Role IDs"
        },
        "permissions": {
          "type": "array",
          "items": {
            "type": "string",
            "format": "uuid"
          },
          "minItems": 0,
          "description": "References to Permission IDs"
        },
        "resources": {
          "type": "array",
          "items": {
            "type": "string",
            "format": "uuid"
          },
          "minItems": 1,
          "description": "References to SecureResource IDs"
        },
        "informationEntities": {
          "type": "array",
          "items": {
            "type": "string",
            "format": "uuid"
          },
          "minItems": 0,
          "description": "References to InformationEntity IDs"
        },
        "delegations": {
          "type": "array",
          "items": {
            "type": "string",
            "format": "uuid"
          },
          "minItems": 0,
          "description": "References to Delegation IDs"
        },
        "securityConstraints": {
          "type": "array",
          "items": {
            "type": "string",
            "format": "uuid"
          },
          "minItems": 0,
          "maxItems": 1,
          "description": "References to SecurityConstraints IDs"
        },
        "policies": {
          "type": "array",
          "items": {
            "type": "string",
            "format": "uuid"
          },
          "minItems": 0,
          "description": "References to SecurityPolicy IDs"
        },
        "dataClassification": {
          "type": "array",
          "items": {
            "type": "string",
            "format": "uuid"
          },
          "minItems": 1,
          "maxItems": 1,
          "description": "References to DataClassification IDs"
        },
        "socialDependencies": {
          "type": "array",
          "items": {
            "type": "string",
            "format": "uuid"
          },
          "minItems": 0,
          "description": "References to SocialDependency IDs"
        },
        "accountability": {
          "type": "array",
          "items": {
            "type": "string",
            "format": "uuid"
          },
          "minItems": 0,
          "description": "References to AccountabilityRequirement IDs"
        },
        "threats": {
          "type": "array",
          "items": {
            "type": "string",
            "format": "uuid"
          },
          "minItems": 0,
          "description": "References to Threat IDs"
        }
      }
    },
    "AuthenticationConfig": {
      "type": "object",
      "description": "Authentication configuration",
      "required": [
        "id",
        "name",
        "provider",
        "sessionTimeout"
      ],
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid"
        },
        "name": {
          "type": "string",
          "minLength": 1
        },
        "provider": {
          "type": "string",
          "enum": [
            "oauth2",
            "openid-connect",
            "saml",
            "jwt",
            "session",
            "api-key",
            "certificate"
          ]
        },
        "sessionTimeout": {
          "type": "integer"
        },
        "mfaRequired": {
          "type": "boolean"
        },
        "passwordPolicy": {
          "type": "string"
        }
      }
    },
    "PasswordPolicy": {
      "type": "object",
      "description": "Password requirements",
      "required": [
        "id",
        "name",
        "expiryDays"
      ],
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid"
        },
        "name": {
          "type": "string",
          "minLength": 1
        },
        "minLength": {
          "type": "integer"
        },
        "maxLength": {
          "type": "integer"
        },
        "requireUppercase": {
          "type": "boolean"
        },
        "requireLowercase": {
          "type": "boolean"
        },
        "requireNumbers": {
          "type": "boolean"
        },
        "requireSpecialChars": {
          "type": "boolean"
        },
        "preventReuse": {
          "type": "integer"
        },
        "expiryDays": {
          "type": "integer"
        },
        "lockoutAttempts": {
          "type": "integer"
        },
        "lockoutDuration": {
          "type": "integer"
        }
      }
    },
    "Role": {
      "type": "object",
      "description": "User role definition",
      "required": [
        "id",
        "name",
        "displayName",
        "level",
        "inheritsFrom"
      ],
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid"
        },
        "name": {
          "type": "string",
          "minLength": 1
        },
        "displayName": {
          "type": "string"
        },
        "description": {
          "type": "string"
        },
        "level": {
          "type": "integer"
        },
        "inheritsFrom": {
          "type": "string"
        },
        "permissions": {
          "type": "array",
          "items": {
            "type": "string",
            "format": "uuid"
          },
          "minItems": 0,
          "description": "References to Permission IDs"
        }
      }
    },
    "Permission": {
      "type": "object",
      "description": "Permission definition",
      "required": [
        "id",
        "name",
        "scope",
        "resource",
        "action"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "id": {
          "type": "string",
          "format": "uuid"
        },
        "description": {
          "type": "string"
        },
        "scope": {
          "type": "string",
          "enum": [
            "global",
            "resource",
            "attribute",
            "owner"
          ]
        },
        "resource": {
          "type": "string"
        },
        "action": {
          "type": "string"
        }
      }
    },
    "SecureResource": {
      "type": "object",
      "description": "Protected resource definition",
      "required": [
        "id",
        "name",
        "resource",
        "type"
      ],
      "properties": {
        "resource": {
          "type": "string"
        },
        "id": {
          "type": "string",
          "format": "uuid"
        },
        "name": {
          "type": "string",
          "minLength": 1
        },
        "type": {
          "type": "string",
          "enum": [
            "api",
            "screen",
            "data",
            "file",
            "service"
          ]
        },
        "description": {
          "type": "string"
        },
        "operations": {
          "type": "array",
          "items": {
            "type": "string",
            "format": "uuid"
          },
          "minItems": 1,
          "description": "References to ResourceOperation IDs"
        },
        "fieldAccess": {
          "type": "array",
          "items": {
            "type": "string",
            "format": "uuid"
          },
          "minItems": 0,
          "description": "References to FieldAccessControl IDs"
        }
      }
    },
    "ResourceOperation": {
      "type": "object",
      "description": "Operation on a resource",
      "required": [
        "id",
        "name",
        "operation"
      ],
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid"
        },
        "name": {
          "type": "string",
          "minLength": 1
        },
        "operation": {
          "type": "string"
        },
        "description": {
          "type": "string"
        },
        "conditions": {
          "type": "array",
          "items": {
            "type": "string",
            "format": "uuid"
          },
          "minItems": 0,
          "description": "References to AccessCondition IDs"
        },
        "rateLimit": {
          "type": "array",
          "items": {
            "type": "string",
            "format": "uuid"
          },
          "minItems": 0,
          "maxItems": 1,
          "description": "References to RateLimit IDs"
        },
        "audit": {
          "type": "array",
          "items": {
            "type": "string",
            "format": "uuid"
          },
          "minItems": 0,
          "maxItems": 1,
          "description": "References to AuditConfig IDs"
        }
      }
    },
    "AccessCondition": {
      "type": "object",
      "description": "Conditional access rule",
      "required": [
        "id",
        "name",
        "field",
        "operator",
        "value",
        "message",
        "source"
      ],
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid"
        },
        "name": {
          "type": "string",
          "minLength": 1
        },
        "field": {
          "type": "string"
        },
        "operator": {
          "type": "string",
          "enum": [
            "equals",
            "notEquals",
            "in",
            "notIn",
            "greaterThan",
            "lessThan",
            "greaterThanOrEqual",
            "lessThanOrEqual",
            "contains",
            "notContains",
            "startsWith",
            "endsWith",
            "matches",
            "exists",
            "notExists"
          ]
        },
        "value": {
          "type": "string"
        },
        "message": {
          "type": "string"
        },
        "source": {
          "type": "string",
          "enum": [
            "constant",
            "user-attribute",
            "resource-field",
            "context",
            "computed"
          ]
        }
      }
    },
    "FieldAccessControl": {
      "type": "object",
      "description": "Field-level access control",
      "required": [
        "id",
        "name",
        "field"
      ],
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid"
        },
        "name": {
          "type": "string",
          "minLength": 1
        },
        "field": {
          "type": "string"
        },
        "description": {
          "type": "string"
        }
      }
    },
    "SecurityPolicy": {
      "type": "object",
      "description": "Declarative security policy",
      "required": [
        "id",
        "name",
        "priority",
        "target"
      ],
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid"
        },
        "name": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string"
        },
        "enabled": {
          "type": "boolean"
        },
        "priority": {
          "type": "integer"
        },
        "target": {
          "type": "string",
          "enum": [
            "all",
            "api",
            "data",
            "screen"
          ]
        },
        "rules": {
          "type": "array",
          "items": {
            "type": "string",
            "format": "uuid"
          },
          "minItems": 1,
          "description": "References to PolicyRule IDs"
        }
      }
    },
    "PolicyRule": {
      "type": "object",
      "description": "Individual policy rule",
      "required": [
        "id",
        "name",
        "condition",
        "effect"
      ],
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid"
        },
        "name": {
          "type": "string",
          "minLength": 1
        },
        "condition": {
          "type": "string"
        },
        "effect": {
          "type": "string",
          "enum": [
            "allow",
            "deny",
            "audit",
            "warn"
          ]
        },
        "message": {
          "type": "string"
        },
        "actions": {
          "type": "array",
          "items": {
            "type": "string",
            "format": "uuid"
          },
          "minItems": 0,
          "description": "References to PolicyAction IDs"
        }
      }
    },
    "PolicyAction": {
      "type": "object",
      "description": "Action to take when policy rule matches",
      "required": [
        "id",
        "name",
        "type",
        "parameters"
      ],
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid"
        },
        "name": {
          "type": "string",
          "minLength": 1
        },
        "type": {
          "type": "string",
          "enum": [
            "allow",
            "deny",
            "audit-access",
            "require-mfa",
            "require-approval",
            "apply-mask",
            "apply-encryption",
            "apply-retention",
            "notify",
            "rate-limit",
            "check-ip-whitelist",
            "check-time-window"
          ]
        },
        "parameters": {
          "type": "object"
        }
      }
    },
    "Actor": {
      "type": "object",
      "description": "Actor in the system (beyond roles)",
      "required": [
        "id",
        "name",
        "type"
      ],
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid"
        },
        "name": {
          "type": "string",
          "minLength": 1
        },
        "type": {
          "type": "string",
          "enum": [
            "role",
            "agent",
            "organization",
            "system"
          ]
        },
        "description": {
          "type": "string"
        },
        "trustLevel": {
          "type": "string",
          "enum": [
            "none",
            "low",
            "medium",
            "high",
            "full"
          ]
        },
        "objectives": {
          "type": "array",
          "items": {
            "type": "string",
            "format": "uuid"
          },
          "minItems": 0,
          "description": "References to ActorObjective IDs"
        },
        "dependencies": {
          "type": "array",
          "items": {
            "type": "string",
            "format": "uuid"
          },
          "minItems": 0,
          "description": "References to ActorDependency IDs"
        }
      }
    },
    "ActorObjective": {
      "type": "object",
      "description": "Security-related objective or goal of an actor",
      "required": [
        "id",
        "name",
        "description"
      ],
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid"
        },
        "name": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string"
        },
        "criticality": {
          "type": "string",
          "enum": [
            "low",
            "medium",
            "high",
            "critical"
          ]
        }
      }
    },
    "ActorDependency": {
      "type": "object",
      "description": "Dependency between actors",
      "required": [
        "id",
        "name",
        "dependee",
        "resource",
        "objective",
        "criticality"
      ],
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid"
        },
        "name": {
          "type": "string",
          "minLength": 1
        },
        "dependee": {
          "type": "string"
        },
        "resource": {
          "type": "string"
        },
        "objective": {
          "type": "string"
        },
        "criticality": {
          "type": "string"
        }
      }
    },
    "InformationEntity": {
      "type": "object",
      "description": "Information asset with fine-grained rights",
      "required": [
        "id",
        "name",
        "classification"
      ],
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid"
        },
        "name": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string"
        },
        "classification": {
          "type": "string"
        },
        "authorizationRequirements": {
          "type": "array",
          "items": {
            "type": "string",
            "format": "uuid"
          },
          "minItems": 1,
          "description": "References to InformationRight IDs"
        }
      }
    },
    "InformationRight": {
      "type": "object",
      "description": "Fine-grained information access rights",
      "required": [
        "id",
        "name",
        "actor",
        "constraint"
      ],
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid"
        },
        "name": {
          "type": "string",
          "minLength": 1
        },
        "actor": {
          "type": "string"
        },
        "constraint": {
          "type": "string"
        }
      }
    },
    "Delegation": {
      "type": "object",
      "description": "Explicit delegation of permissions or goals",
      "required": [
        "id",
        "name",
        "delegator",
        "delegatee",
        "delegationType"
      ],
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid"
        },
        "name": {
          "type": "string",
          "minLength": 1
        },
        "delegator": {
          "type": "string"
        },
        "delegatee": {
          "type": "string"
        },
        "delegationType": {
          "type": "string",
          "enum": [
            "execution",
            "permission",
            "approval"
          ]
        },
        "description": {
          "type": "string"
        }
      }
    },
    "SocialDependency": {
      "type": "object",
      "description": "Dependencies and trust between actors",
      "required": [
        "id",
        "name",
        "depender",
        "dependee",
        "resource",
        "objective",
        "criticality"
      ],
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid"
        },
        "name": {
          "type": "string",
          "minLength": 1
        },
        "depender": {
          "type": "string"
        },
        "dependee": {
          "type": "string"
        },
        "resource": {
          "type": "string"
        },
        "objective": {
          "type": "string"
        },
        "criticality": {
          "type": "string"
        }
      }
    },
    "AccountabilityRequirement": {
      "type": "object",
      "description": "Accountability and non-repudiation requirements",
      "required": [
        "id",
        "name",
        "action",
        "resource",
        "nonRepudiation",
        "purposeDeclaration",
        "challengeable"
      ],
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid"
        },
        "name": {
          "type": "string",
          "minLength": 1
        },
        "action": {
          "type": "string"
        },
        "resource": {
          "type": "string"
        },
        "nonRepudiation": {
          "type": "boolean"
        },
        "purposeDeclaration": {
          "type": "string",
          "enum": [
            "none",
            "optional",
            "required",
            "mandatory"
          ]
        },
        "challengeable": {
          "type": "boolean"
        }
      }
    },
    "Evidence": {
      "type": "object",
      "description": "Evidence required for accountability",
      "required": [
        "id",
        "name",
        "type",
        "source"
      ],
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid"
        },
        "name": {
          "type": "string",
          "minLength": 1
        },
        "type": {
          "type": "string",
          "enum": [
            "digital-signature",
            "timestamp",
            "ip-address",
            "device-fingerprint",
            "biometric",
            "user-authentication",
            "access-reason",
            "approval-chain",
            "video-recording"
          ]
        },
        "strength": {
          "type": "string",
          "enum": [
            "weak",
            "moderate",
            "strong",
            "cryptographic"
          ]
        },
        "source": {
          "type": "string"
        }
      }
    },
    "Threat": {
      "type": "object",
      "description": "Security threat and countermeasures",
      "required": [
        "id",
        "name",
        "description",
        "threatens",
        "likelihood",
        "impact"
      ],
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid"
        },
        "name": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string"
        },
        "threatens": {
          "type": "string"
        },
        "likelihood": {
          "type": "string",
          "enum": [
            "very-low",
            "low",
            "medium",
            "high",
            "very-high"
          ]
        },
        "impact": {
          "type": "string",
          "enum": [
            "negligible",
            "low",
            "medium",
            "high",
            "critical"
          ]
        },
        "countermeasures": {
          "type": "array",
          "items": {
            "type": "string",
            "format": "uuid"
          },
          "minItems": 0,
          "description": "References to Countermeasure IDs"
        }
      }
    },
    "Countermeasure": {
      "type": "object",
      "description": "Security countermeasure for a threat",
      "required": [
        "id",
        "name",
        "type",
        "description"
      ],
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid"
        },
        "name": {
          "type": "string",
          "minLength": 1
        },
        "type": {
          "type": "string"
        },
        "description": {
          "type": "string"
        },
        "effectiveness": {
          "type": "string",
          "enum": [
            "low",
            "medium",
            "high",
            "very-high"
          ]
        },
        "implemented": {
          "type": "boolean"
        }
      }
    },
    "Relationship": {
      "type": "object",
      "required": [
        "type",
        "source",
        "target"
      ],
      "properties": {
        "type": {
          "type": "string",
          "enum": [
            "Composition",
            "Aggregation",
            "Assignment",
            "Realization",
            "Triggering",
            "Flow",
            "Association",
            "Access",
            "Serving"
          ]
        },
        "source": {
          "type": "string",
          "format": "uuid"
        },
        "target": {
          "type": "string",
          "format": "uuid"
        },
        "documentation": {
          "type": "string"
        }
      }
    }
  }
}
