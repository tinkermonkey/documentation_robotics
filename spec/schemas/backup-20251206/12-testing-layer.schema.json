{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://example.com/schemas/12-testing-layer.json",
  "title": "Testing Layer Schema",
  "type": "object",
  "description": "ArchiMate Testing Layer elements for business services, processes, actors, and objects",
  "properties": {
    "testCoverageModels": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/TestCoverageModel"
      }
    },
    "testCoverageTargets": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/TestCoverageTarget"
      }
    },
    "targetInputFields": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/TargetInputField"
      }
    },
    "inputSpacePartitions": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/InputSpacePartition"
      }
    },
    "partitionValues": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/PartitionValue"
      }
    },
    "partitionDependencies": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/PartitionDependency"
      }
    },
    "contextVariations": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/ContextVariation"
      }
    },
    "environmentFactors": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/EnvironmentFactor"
      }
    },
    "outcomeCategories": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/OutcomeCategory"
      }
    },
    "coverageRequirements": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/CoverageRequirement"
      }
    },
    "inputPartitionSelections": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/InputPartitionSelection"
      }
    },
    "coverageExclusions": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/CoverageExclusion"
      }
    },
    "testCaseSketches": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/TestCaseSketch"
      }
    },
    "inputSelections": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/InputSelection"
      }
    },
    "relationships": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/Relationship"
      }
    }
  },
  "definitions": {
    "TestCoverageModel": {
      "type": "object",
      "description": "Complete test coverage model for application",
      "required": [
        "id",
        "name",
        "version",
        "application"
      ],
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid"
        },
        "name": {
          "type": "string",
          "minLength": 1
        },
        "version": {
          "type": "string"
        },
        "application": {
          "type": "string"
        },
        "description": {
          "type": "string"
        },
        "coverageTargets": {
          "type": "array",
          "items": {
            "type": "string",
            "format": "uuid"
          },
          "minItems": 1,
          "description": "References to TestCoverageTarget IDs"
        },
        "inputSpacePartitions": {
          "type": "array",
          "items": {
            "type": "string",
            "format": "uuid"
          },
          "minItems": 0,
          "description": "References to InputSpacePartition IDs"
        },
        "contextVariations": {
          "type": "array",
          "items": {
            "type": "string",
            "format": "uuid"
          },
          "minItems": 0,
          "description": "References to ContextVariation IDs"
        },
        "coverageRequirements": {
          "type": "array",
          "items": {
            "type": "string",
            "format": "uuid"
          },
          "minItems": 1,
          "description": "References to CoverageRequirement IDs"
        },
        "testCaseSketches": {
          "type": "array",
          "items": {
            "type": "string",
            "format": "uuid"
          },
          "minItems": 0,
          "description": "References to TestCaseSketch IDs"
        }
      }
    },
    "TestCoverageTarget": {
      "type": "object",
      "description": "An artifact or functionality that requires test coverage",
      "required": [
        "id",
        "name",
        "targetType"
      ],
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid"
        },
        "name": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string"
        },
        "targetType": {
          "type": "string",
          "enum": [
            "workflow",
            "workflow-step",
            "form",
            "api-operation",
            "data-transform",
            "navigation-path",
            "integration",
            "composite"
          ]
        },
        "priority": {
          "type": "string",
          "enum": [
            "critical",
            "high",
            "medium",
            "low"
          ]
        },
        "applicableContexts": {
          "type": "array",
          "items": {
            "type": "string",
            "format": "uuid"
          },
          "minItems": 0,
          "description": "References to string IDs"
        },
        "inputFields": {
          "type": "array",
          "items": {
            "type": "string",
            "format": "uuid"
          },
          "minItems": 0,
          "description": "References to TargetInputField IDs"
        },
        "outcomeCategories": {
          "type": "array",
          "items": {
            "type": "string",
            "format": "uuid"
          },
          "minItems": 0,
          "description": "References to OutcomeCategory IDs"
        }
      }
    },
    "TargetInputField": {
      "type": "object",
      "description": "Input field associated with a coverage target",
      "required": [
        "id",
        "name",
        "fieldRef",
        "partitionRef"
      ],
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid"
        },
        "name": {
          "type": "string",
          "minLength": 1
        },
        "fieldRef": {
          "type": "string"
        },
        "partitionRef": {
          "type": "string"
        },
        "description": {
          "type": "string"
        },
        "relevance": {
          "type": "string",
          "enum": [
            "primary",
            "secondary",
            "contextual"
          ]
        }
      }
    },
    "InputSpacePartition": {
      "type": "object",
      "description": "Partitioning of an input dimension into testable categories",
      "required": [
        "id",
        "name",
        "fieldRef",
        "presenceRule"
      ],
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid"
        },
        "name": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string"
        },
        "fieldRef": {
          "type": "string"
        },
        "presenceRule": {
          "type": "string",
          "enum": [
            "required",
            "optional",
            "conditional"
          ]
        },
        "partitions": {
          "type": "array",
          "items": {
            "type": "string",
            "format": "uuid"
          },
          "minItems": 1,
          "description": "References to PartitionValue IDs"
        },
        "dependencies": {
          "type": "array",
          "items": {
            "type": "string",
            "format": "uuid"
          },
          "minItems": 0,
          "description": "References to PartitionDependency IDs"
        }
      }
    },
    "PartitionValue": {
      "type": "object",
      "description": "A specific partition within the input space",
      "required": [
        "id",
        "name",
        "label",
        "constraint",
        "constraintExpression",
        "category",
        "representativeValue"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "id": {
          "type": "string",
          "format": "uuid"
        },
        "label": {
          "type": "string"
        },
        "description": {
          "type": "string"
        },
        "constraint": {
          "type": "string"
        },
        "constraintExpression": {
          "type": "string"
        },
        "category": {
          "type": "string",
          "enum": [
            "typical",
            "boundary",
            "invalid",
            "None",
            "special"
          ]
        },
        "representativeValue": {
          "type": "string"
        }
      }
    },
    "PartitionDependency": {
      "type": "object",
      "description": "Constraint between partition values across fields",
      "required": [
        "id",
        "name",
        "dependsOnPartition",
        "dependsOnValue",
        "effect",
        "affectedValues"
      ],
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid"
        },
        "name": {
          "type": "string",
          "minLength": 1
        },
        "dependsOnPartition": {
          "type": "string"
        },
        "dependsOnValue": {
          "type": "string"
        },
        "effect": {
          "type": "string",
          "enum": [
            "requires",
            "excludes",
            "enables",
            "modifies"
          ]
        },
        "affectedValues": {
          "type": "string"
        },
        "description": {
          "type": "string"
        }
      }
    },
    "ContextVariation": {
      "type": "object",
      "description": "Different context in which functionality can be invoked",
      "required": [
        "id",
        "name",
        "contextType"
      ],
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid"
        },
        "name": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string"
        },
        "contextType": {
          "type": "string",
          "enum": [
            "ui-entry",
            "api-entry",
            "event-triggered",
            "scheduled",
            "integration"
          ]
        },
        "environmentFactors": {
          "type": "array",
          "items": {
            "type": "string",
            "format": "uuid"
          },
          "minItems": 0,
          "description": "References to EnvironmentFactor IDs"
        }
      }
    },
    "EnvironmentFactor": {
      "type": "object",
      "description": "Environmental condition that may affect behavior",
      "required": [
        "id",
        "name",
        "factor",
        "value"
      ],
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid"
        },
        "name": {
          "type": "string",
          "minLength": 1
        },
        "factor": {
          "type": "string"
        },
        "value": {
          "type": "string"
        },
        "description": {
          "type": "string"
        }
      }
    },
    "OutcomeCategory": {
      "type": "object",
      "description": "Category of expected outcomes (not specific assertions)",
      "required": [
        "id",
        "name",
        "outcomeType",
        "httpStatusRange"
      ],
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid"
        },
        "name": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string"
        },
        "outcomeType": {
          "type": "string",
          "enum": [
            "success",
            "validation-error",
            "authorization-denied",
            "not-found",
            "conflict",
            "precondition-failed",
            "idempotent-noop",
            "partial-success",
            "error"
          ]
        },
        "httpStatusRange": {
          "type": "string"
        }
      }
    },
    "CoverageRequirement": {
      "type": "object",
      "description": "Requirement for test coverage of a target",
      "required": [
        "id",
        "name",
        "coverageCriteria"
      ],
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid"
        },
        "name": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string"
        },
        "coverageCriteria": {
          "type": "string",
          "enum": [
            "exhaustive",
            "pairwise",
            "each-choice",
            "boundary",
            "risk-based",
            "happy-path",
            "error-path"
          ]
        },
        "priority": {
          "type": "string"
        },
        "inputPartitionSelections": {
          "type": "array",
          "items": {
            "type": "string",
            "format": "uuid"
          },
          "minItems": 0,
          "description": "References to InputPartitionSelection IDs"
        },
        "contextSelections": {
          "type": "array",
          "items": {
            "type": "string",
            "format": "uuid"
          },
          "minItems": 0,
          "description": "References to string IDs"
        },
        "outcomeSelections": {
          "type": "array",
          "items": {
            "type": "string",
            "format": "uuid"
          },
          "minItems": 0,
          "description": "References to string IDs"
        },
        "exclusions": {
          "type": "array",
          "items": {
            "type": "string",
            "format": "uuid"
          },
          "minItems": 0,
          "description": "References to CoverageExclusion IDs"
        }
      }
    },
    "InputPartitionSelection": {
      "type": "object",
      "description": "Selection of partition values to include in coverage",
      "required": [
        "id",
        "name",
        "partitionRef",
        "coverValues",
        "coverAllCategories",
        "excludeValues"
      ],
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid"
        },
        "name": {
          "type": "string",
          "minLength": 1
        },
        "partitionRef": {
          "type": "string"
        },
        "coverValues": {
          "type": "string"
        },
        "coverAllCategories": {
          "type": "boolean"
        },
        "excludeValues": {
          "type": "string"
        }
      }
    },
    "CoverageExclusion": {
      "type": "object",
      "description": "Explicit exclusion from coverage with justification",
      "required": [
        "id",
        "name",
        "description",
        "reason",
        "riskAccepted",
        "approvedBy"
      ],
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid"
        },
        "name": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string"
        },
        "reason": {
          "type": "string"
        },
        "riskAccepted": {
          "type": "boolean"
        },
        "approvedBy": {
          "type": "string"
        }
      }
    },
    "TestCaseSketch": {
      "type": "object",
      "description": "Abstract test case selecting specific partition values",
      "required": [
        "id",
        "name",
        "status"
      ],
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid"
        },
        "name": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string"
        },
        "status": {
          "type": "string",
          "enum": [
            "planned",
            "implemented",
            "automated",
            "manual",
            "blocked",
            "deprecated"
          ]
        },
        "inputSelections": {
          "type": "array",
          "items": {
            "type": "string",
            "format": "uuid"
          },
          "minItems": 1,
          "description": "References to InputSelection IDs"
        }
      }
    },
    "InputSelection": {
      "type": "object",
      "description": "Specific partition value selected for a test case",
      "required": [
        "id",
        "name",
        "partitionRef",
        "selectedValue",
        "concreteValue",
        "valueSource"
      ],
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid"
        },
        "name": {
          "type": "string",
          "minLength": 1
        },
        "partitionRef": {
          "type": "string"
        },
        "selectedValue": {
          "type": "string"
        },
        "concreteValue": {
          "type": "string"
        },
        "valueSource": {
          "type": "string"
        }
      }
    },
    "Relationship": {
      "type": "object",
      "required": [
        "type",
        "source",
        "target"
      ],
      "properties": {
        "type": {
          "type": "string",
          "enum": [
            "Composition",
            "Aggregation",
            "Assignment",
            "Realization",
            "Triggering",
            "Flow",
            "Association",
            "Access",
            "Serving"
          ]
        },
        "source": {
          "type": "string",
          "format": "uuid"
        },
        "target": {
          "type": "string",
          "format": "uuid"
        },
        "documentation": {
          "type": "string"
        }
      }
    }
  }
}
