{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://github.com/tinkermonkey/documentation_robotics/spec/nodes/security/ratelimit.node.schema.json",
  "title": "RateLimit",
  "description": "Defines throttling constraints for API or service access, specifying maximum request counts, time windows, and actions to take when limits are exceeded. Protects resources from abuse and ensures fair usage across consumers.",
  "allOf": [
    {
      "$ref": "../../schemas/base/spec-node.schema.json"
    }
  ],
  "properties": {
    "spec_node_id": {
      "const": "security.ratelimit"
    },
    "layer_id": {
      "const": "security"
    },
    "type": {
      "const": "ratelimit"
    },
    "attributes": {
      "type": "object",
      "properties": {
        "requests": {
          "type": "integer"
        },
        "window": {
          "type": "string"
        },
        "scope": {
          "type": "string",
          "enum": [
            "global",
            "user",
            "ip",
            "api-key",
            "tenant"
          ]
        },
        "keyBy": {
          "type": "string"
        },
        "action": {
          "type": "string",
          "enum": [
            "reject",
            "queue",
            "throttle",
            "degrade"
          ],
          "description": "RateLimitAction classification"
        }
      },
      "required": [
        "requests",
        "window",
        "keyBy"
      ],
      "additionalProperties": false
    }
  }
}
