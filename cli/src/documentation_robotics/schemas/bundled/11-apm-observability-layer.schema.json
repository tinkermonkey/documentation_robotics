{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://example.com/schemas/11-apm-observability-layer.schema.json",
  "title": "Apm Observability Layer Schema",
  "description": "Schema for Apm Observability Layer",
  "type": "object",
  "properties": {
    "spans": {
      "type": "array",
      "description": "Collection of Span entities",
      "items": {
        "$ref": "#/definitions/Span"
      }
    },
    "span-events": {
      "type": "array",
      "description": "Collection of SpanEvent entities",
      "items": {
        "$ref": "#/definitions/SpanEvent"
      }
    },
    "span-links": {
      "type": "array",
      "description": "Collection of SpanLink entities",
      "items": {
        "$ref": "#/definitions/SpanLink"
      }
    },
    "span-statuses": {
      "type": "array",
      "description": "Collection of SpanStatus entities",
      "items": {
        "$ref": "#/definitions/SpanStatus"
      }
    },
    "log-records": {
      "type": "array",
      "description": "Collection of LogRecord entities",
      "items": {
        "$ref": "#/definitions/LogRecord"
      }
    },
    "resources": {
      "type": "array",
      "description": "Collection of Resource entities",
      "items": {
        "$ref": "#/definitions/Resource"
      }
    },
    "instrumentation-scopes": {
      "type": "array",
      "description": "Collection of InstrumentationScope entities",
      "items": {
        "$ref": "#/definitions/InstrumentationScope"
      }
    },
    "attributes": {
      "type": "array",
      "description": "Collection of Attribute entities",
      "items": {
        "$ref": "#/definitions/Attribute"
      }
    },
    "apm-configurations": {
      "type": "array",
      "description": "Collection of APMConfiguration entities",
      "items": {
        "$ref": "#/definitions/APMConfiguration"
      }
    },
    "trace-configurations": {
      "type": "array",
      "description": "Collection of TraceConfiguration entities",
      "items": {
        "$ref": "#/definitions/TraceConfiguration"
      }
    },
    "log-configurations": {
      "type": "array",
      "description": "Collection of LogConfiguration entities",
      "items": {
        "$ref": "#/definitions/LogConfiguration"
      }
    },
    "metric-configurations": {
      "type": "array",
      "description": "Collection of MetricConfiguration entities",
      "items": {
        "$ref": "#/definitions/MetricConfiguration"
      }
    },
    "data-quality-metricses": {
      "type": "array",
      "description": "Collection of DataQualityMetrics entities",
      "items": {
        "$ref": "#/definitions/DataQualityMetrics"
      }
    },
    "data-quality-metrics": {
      "type": "array",
      "description": "Collection of DataQualityMetric entities",
      "items": {
        "$ref": "#/definitions/DataQualityMetric"
      }
    }
  },
  "definitions": {
    "Span": {
      "type": "object",
      "description": "Unit of work in distributed tracing",
      "required": [
        "id",
        "traceId",
        "spanId",
        "traceState",
        "parentSpanId",
        "name",
        "spanKind",
        "startTimeUnixNano",
        "endTimeUnixNano",
        "droppedAttributesCount",
        "droppedEventsCount",
        "droppedLinksCount"
      ],
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid",
          "minLength": 1
        },
        "traceId": {
          "type": "string",
          "minLength": 1
        },
        "spanId": {
          "type": "string",
          "minLength": 1
        },
        "traceState": {
          "type": "string",
          "minLength": 1
        },
        "parentSpanId": {
          "type": "string",
          "minLength": 1
        },
        "name": {
          "type": "string",
          "minLength": 1
        },
        "spanKind": {
          "$ref": "#/definitions/enum"
        },
        "startTimeUnixNano": {
          "type": "string",
          "minLength": 1
        },
        "endTimeUnixNano": {
          "type": "string",
          "minLength": 1
        },
        "droppedAttributesCount": {
          "type": "string",
          "minLength": 1
        },
        "droppedEventsCount": {
          "type": "string",
          "minLength": 1
        },
        "droppedLinksCount": {
          "type": "string",
          "minLength": 1
        },
        "attributes": {
          "type": "array",
          "description": "Contains relationship",
          "items": {
            "type": "string"
          }
        },
        "events": {
          "type": "array",
          "description": "Contains relationship",
          "items": {
            "type": "string"
          }
        },
        "links": {
          "type": "array",
          "description": "Contains relationship",
          "items": {
            "type": "string"
          }
        }
      },
      "definitions": {
        "SpanKind": {
          "type": "string",
          "enum": [
            "INTERNAL",
            "SERVER",
            "CLIENT",
            "PRODUCER",
            "CONSUMER"
          ]
        }
      }
    },
    "SpanEvent": {
      "type": "object",
      "description": "Timestamped event during span execution",
      "required": [
        "id",
        "timeUnixNano",
        "name",
        "droppedAttributesCount"
      ],
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid",
          "minLength": 1
        },
        "timeUnixNano": {
          "type": "string",
          "minLength": 1
        },
        "name": {
          "type": "string",
          "minLength": 1
        },
        "droppedAttributesCount": {
          "type": "string",
          "minLength": 1
        },
        "attributes": {
          "type": "array",
          "description": "Contains relationship",
          "items": {
            "type": "string"
          }
        }
      }
    },
    "SpanLink": {
      "type": "object",
      "description": "Link to related span (different trace or parent)",
      "required": [
        "id",
        "name",
        "traceId",
        "spanId",
        "droppedAttributesCount"
      ],
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid",
          "minLength": 1
        },
        "name": {
          "type": "string",
          "minLength": 1
        },
        "traceId": {
          "type": "string",
          "minLength": 1
        },
        "spanId": {
          "type": "string",
          "minLength": 1
        },
        "traceState": {
          "type": "string",
          "minLength": 1
        },
        "droppedAttributesCount": {
          "type": "string",
          "minLength": 1
        },
        "attributes": {
          "type": "array",
          "description": "Contains relationship",
          "items": {
            "type": "string"
          }
        }
      }
    },
    "SpanStatus": {
      "type": "object",
      "description": "Outcome of span execution",
      "required": [
        "id",
        "name",
        "code"
      ],
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid",
          "minLength": 1
        },
        "name": {
          "type": "string",
          "minLength": 1
        },
        "code": {
          "$ref": "#/definitions/enum"
        },
        "message": {
          "type": "string",
          "minLength": 1
        }
      },
      "definitions": {
        "StatusCode": {
          "type": "string",
          "enum": [
            "UNSET",
            "OK",
            "ERROR"
          ]
        }
      }
    },
    "LogRecord": {
      "type": "object",
      "description": "OpenTelemetry log entry",
      "required": [
        "id",
        "name",
        "timeUnixNano",
        "observedTimeUnixNano",
        "severityNumber",
        "body",
        "flags",
        "droppedAttributesCount"
      ],
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid",
          "minLength": 1
        },
        "name": {
          "type": "string",
          "minLength": 1
        },
        "timeUnixNano": {
          "type": "string",
          "minLength": 1
        },
        "observedTimeUnixNano": {
          "type": "string",
          "minLength": 1
        },
        "severityNumber": {
          "$ref": "#/definitions/enum"
        },
        "severityText": {
          "type": "string",
          "minLength": 1
        },
        "body": {
          "type": "string",
          "minLength": 1
        },
        "flags": {
          "type": "string",
          "minLength": 1
        },
        "droppedAttributesCount": {
          "type": "string",
          "minLength": 1
        },
        "attributes": {
          "type": "array",
          "description": "Contains relationship",
          "items": {
            "type": "string"
          }
        }
      },
      "definitions": {
        "SeverityNumber": {
          "type": "string",
          "enum": [
            {
              "UNSPECIFIED": 0
            },
            {
              "TRACE": 1
            },
            {
              "TRACE2": 2
            },
            {
              "TRACE3": 3
            },
            {
              "TRACE4": 4
            },
            {
              "DEBUG": 5
            },
            {
              "DEBUG2": 6
            },
            {
              "DEBUG3": 7
            },
            {
              "DEBUG4": 8
            },
            {
              "INFO": 9
            },
            {
              "INFO2": 10
            },
            {
              "INFO3": 11
            },
            {
              "INFO4": 12
            },
            {
              "WARN": 13
            },
            {
              "WARN2": 14
            },
            {
              "WARN3": 15
            },
            {
              "WARN4": 16
            },
            {
              "ERROR": 17
            },
            {
              "ERROR2": 18
            },
            {
              "ERROR3": 19
            },
            {
              "ERROR4": 20
            },
            {
              "FATAL": 21
            },
            {
              "FATAL2": 22
            },
            {
              "FATAL3": 23
            },
            {
              "FATAL4": 24
            }
          ]
        }
      }
    },
    "Resource": {
      "type": "object",
      "description": "Immutable representation of entity producing telemetry",
      "required": [
        "id",
        "name",
        "droppedAttributesCount"
      ],
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid",
          "minLength": 1
        },
        "name": {
          "type": "string",
          "minLength": 1
        },
        "schemaUrl": {
          "type": "string",
          "minLength": 1
        },
        "droppedAttributesCount": {
          "type": "string",
          "minLength": 1
        },
        "attributes": {
          "type": "array",
          "description": "Contains relationship",
          "items": {
            "type": "string"
          }
        }
      }
    },
    "InstrumentationScope": {
      "type": "object",
      "description": "Logical unit of code that generates telemetry",
      "required": [
        "id",
        "name",
        "droppedAttributesCount"
      ],
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid",
          "minLength": 1
        },
        "name": {
          "type": "string",
          "minLength": 1
        },
        "version": {
          "type": "string",
          "minLength": 1
        },
        "schemaUrl": {
          "type": "string",
          "minLength": 1
        },
        "droppedAttributesCount": {
          "type": "string",
          "minLength": 1
        },
        "attributes": {
          "type": "array",
          "description": "Contains relationship",
          "items": {
            "type": "string"
          }
        }
      }
    },
    "Attribute": {
      "type": "object",
      "description": "Key-value pair metadata",
      "required": [
        "id",
        "name",
        "key",
        "value"
      ],
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid",
          "minLength": 1
        },
        "name": {
          "type": "string",
          "minLength": 1
        },
        "key": {
          "type": "string",
          "minLength": 1
        },
        "value": {
          "type": "string",
          "minLength": 1
        }
      }
    },
    "APMConfiguration": {
      "type": "object",
      "description": "Complete APM configuration for an application",
      "required": [
        "id",
        "name",
        "version",
        "application"
      ],
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid",
          "minLength": 1
        },
        "name": {
          "type": "string",
          "minLength": 1
        },
        "version": {
          "type": "string",
          "minLength": 1
        },
        "application": {
          "type": "string",
          "minLength": 1
        }
      }
    },
    "TraceConfiguration": {
      "type": "object",
      "description": "Distributed tracing configuration",
      "required": [
        "id",
        "name",
        "serviceName"
      ],
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid",
          "minLength": 1
        },
        "name": {
          "type": "string",
          "minLength": 1
        },
        "serviceName": {
          "type": "string",
          "minLength": 1
        },
        "serviceVersion": {
          "type": "string",
          "minLength": 1
        },
        "deploymentEnvironment": {
          "type": "string",
          "minLength": 1
        }
      },
      "definitions": {
        "SamplerType": {
          "type": "string",
          "enum": [
            "always_on",
            "always_off",
            "traceidratio",
            "parentbased_always_on",
            "parentbased_always_off",
            "parentbased_traceidratio"
          ]
        },
        "PropagatorType": {
          "type": "string",
          "enum": [
            "w3c-trace-context",
            "w3c-baggage",
            "b3",
            "jaeger",
            "xray",
            "ottrace"
          ]
        }
      }
    },
    "LogConfiguration": {
      "type": "object",
      "description": "Logging configuration",
      "required": [
        "name",
        "id",
        "serviceName",
        "logLevel"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "id": {
          "type": "string",
          "format": "uuid",
          "minLength": 1
        },
        "serviceName": {
          "type": "string",
          "minLength": 1
        },
        "logLevel": {
          "$ref": "#/definitions/enum"
        }
      },
      "definitions": {
        "LogLevel": {
          "type": "string",
          "enum": [
            "TRACE",
            "DEBUG",
            "INFO",
            "WARN",
            "ERROR",
            "FATAL"
          ]
        }
      }
    },
    "MetricConfiguration": {
      "type": "object",
      "description": "Metrics configuration",
      "required": [
        "id",
        "name",
        "serviceName"
      ],
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid",
          "minLength": 1
        },
        "name": {
          "type": "string",
          "minLength": 1
        },
        "serviceName": {
          "type": "string",
          "minLength": 1
        },
        "exportIntervalMillis": {
          "type": "integer"
        }
      }
    },
    "DataQualityMetrics": {
      "type": "object",
      "description": "Data quality monitoring metrics (referenced by Data Model Layer x-apm-data-quality-metrics)",
      "required": [
        "schemaRef"
      ],
      "properties": {
        "schemaRef": {
          "type": "string",
          "minLength": 1
        },
        "monitoringEnabled": {
          "type": "boolean"
        },
        "metrics": {
          "type": "array",
          "description": "Contains relationship",
          "items": {
            "type": "string"
          }
        }
      }
    },
    "DataQualityMetric": {
      "type": "object",
      "description": "Individual data quality metric",
      "required": [
        "type",
        "name",
        "measurement",
        "threshold"
      ],
      "properties": {
        "type": {
          "$ref": "#/definitions/enum"
        },
        "name": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string",
          "minLength": 1
        },
        "measurement": {
          "type": "string",
          "minLength": 1
        },
        "threshold": {
          "type": "string",
          "minLength": 1
        },
        "alertOnViolation": {
          "type": "boolean"
        }
      },
      "definitions": {
        "DataQualityType": {
          "type": "string",
          "enum": [
            "completeness",
            "accuracy",
            "freshness",
            "consistency",
            "uniqueness",
            "validity",
            "timeliness",
            "integrity"
          ]
        }
      }
    }
  }
}
