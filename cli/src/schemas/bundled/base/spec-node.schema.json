{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://github.com/tinkermonkey/documentation_robotics/spec/schemas/base/spec-node.schema.json",
  "title": "SpecNode",
  "description": "Base schema for all spec node types. Each node type schema extends this with type-specific attribute constraints via allOf.",
  "type": "object",
  "required": ["id", "spec_node_id", "type", "name"],
  "additionalProperties": false,
  "properties": {
    "id": {
      "type": "string",
      "format": "uuid",
      "description": "Unique node instance identifier (UUIDv4). Globally unique across the entire model.",
      "examples": ["550e8400-e29b-41d4-a716-446655440000"]
    },
    "spec_node_id": {
      "type": "string",
      "pattern": "^[a-z-]+\\.[a-z][a-z0-9-]*$",
      "description": "Reference to the spec node type that this node conforms to (e.g., 'motivation.goal')"
    },
    "type": {
      "type": "string",
      "description": "Denormalized node type for efficient filtering and queries. Extracted from spec_node_id (the part after the dot).",
      "examples": ["goal", "requirement", "endpoint", "table"]
    },
    "layer_id": {
      "type": "string",
      "pattern": "^[a-z][a-z0-9-]*$",
      "description": "Denormalized layer ID for efficient layer-scoped queries. Extracted from spec_node_id (the part before the dot)."
    },
    "name": {
      "type": "string",
      "description": "Human-readable instance name",
      "examples": ["Improve Customer Satisfaction", "User Login API", "Customer Table"]
    },
    "description": {
      "type": "string",
      "description": "Optional detailed description of this specific node instance"
    },
    "attributes": {
      "type": "object",
      "description": "Attribute values for this node instance. Keys must correspond to attributes defined in the per-type schema, and values must conform to the type constraints."
    },
    "source_reference": {
      "$ref": "./source-references.schema.json#/definitions/SourceReference",
      "description": "Optional provenance tracking linking this node to source code locations"
    },
    "metadata": {
      "type": "object",
      "description": "Optional metadata about the lifecycle and version of this node instance",
      "additionalProperties": false,
      "properties": {
        "created_at": {
          "type": "string",
          "format": "date-time",
          "description": "ISO 8601 timestamp when this node was created"
        },
        "updated_at": {
          "type": "string",
          "format": "date-time",
          "description": "ISO 8601 timestamp of the last modification"
        },
        "created_by": {
          "type": "string",
          "description": "User or system that created this node"
        },
        "version": {
          "type": "integer",
          "minimum": 1,
          "description": "Version number of this node (incremented on updates)"
        }
      }
    }
  }
}
